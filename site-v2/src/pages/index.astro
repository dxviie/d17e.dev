---
import BaseHead from "../components/BaseHead.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import Navigation from "../components/Navigation.astro";
import LandingLogo from "../components/LandingLogo.svelte";
import HydraBackground from "../components/HydraBackground.svelte";
import Footer from "../components/Footer.astro";
import SocialLinks from "../components/SocialLinks.astro";
import FeaturedGrid from "../components/FeaturedGrid.astro";
import MobileNavigation from "../components/MobileNavigation.astro";
import { getCollection } from "astro:content";

// Featured content slugs - update these to feature different content (up to 3 per section)
const FEATURED_PROJECT_SLUGS = ["rstr", "genuary"];
const FEATURED_POST_SLUGS = [
    "rstr-cmy-pet-plot",
    "welcome-to-the-purple-room",
];
const FEATURED_ARTICLE_SLUGS = [
    "how-i-ended-up-building-hydractrl",
    "creative-coding-amsterdam-plotter-special",
];

const IMG_URL_BASE = "https://directus.d17e.dev/assets";
const IMG_OPTIMIZED_PARAMS = "?width=400&format=webp&quality=80";

// Fetch all content from collections
const projects = await getCollection("projects");
const posts = await getCollection("posts");
const articles = await getCollection("articles");

// Helper to find items by slugs and transform to featured item format
const featuredProjects = FEATURED_PROJECT_SLUGS.map((slug) =>
    projects.find((p) => p.data.slug === slug),
)
    .filter(Boolean)
    .map((p) => ({
        title: p!.data.name,
        href: `/projects/${p!.data.slug}`,
        imageUrl: `${IMG_URL_BASE}/${p!.data.cover.id}${IMG_OPTIMIZED_PARAMS}`,
        imageAlt: p!.data.cover.title,
    }));

const featuredPosts = FEATURED_POST_SLUGS.map((slug) =>
    posts.find((p) => p.data.slug === slug),
)
    .filter(Boolean)
    .map((p) => ({
        title: p!.data.title,
        href: `/posts/${p!.data.slug}`,
        imageUrl: `${IMG_URL_BASE}/${p!.data.cover.id}${IMG_OPTIMIZED_PARAMS}`,
        imageAlt: p!.data.cover.title,
    }));

const featuredArticles = FEATURED_ARTICLE_SLUGS.map((slug) =>
    articles.find((a) => a.data.slug === slug),
)
    .filter(Boolean)
    .map((a) => ({
        title: a!.data.title,
        href: `/blog/${a!.data.slug}`,
        imageUrl: `${IMG_URL_BASE}/${a!.data.cover.id}${IMG_OPTIMIZED_PARAMS}`,
        imageAlt: a!.data.cover.title,
    }));
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
        <!-- Preload LCP image (landing logo placeholder) - only on landing page -->
        <link rel="preload" href="/logo/d17e-logo.webp" as="image" fetchpriority="high"/>
    </head>
    <body>
        <div class="statusbar"></div>
        <!-- Desktop navigation (hidden on mobile/tablet) -->
        <Navigation />
        <!-- Mobile navigation (hidden on desktop) -->
        <MobileNavigation />

        <!-- Hero Section - Full Page LandingLogo -->
        <HydraBackground
            client:visible
            code={`
        noise(9, .01)
         .scale(1, 1, ()=> window.innerWidth / window.innerHeight)
          .color(0.95, 0.92, 0.9)
          .modulateRotate(osc(99, 0.015), 0.05)
          .brightness(0.4)
          .contrast(1.05)
  .luma(.2, 0.3)
  .thresh(.2)
          .out()
      `}
            blendMode="multiply"
            opacity={0.4}
        >
            <section class="hero">
                <LandingLogo client:visible />
            </section>
        </HydraBackground>

        <!-- Introduction Section -->

        <section class="section intro-section">
            <div class="section-content">
                <div class="intro-header">
                    <img
                        src="/me_rstr_cmy_round_s.webp"
                        class="avatar"
                        alt="David Vandenbogaerde"
                        width="150"
                        height="150"
                    />
                    <div class="intro-title">
                        <h1>
                            Hi, I'm <span class="highlight"
                                >David Vandenbogaerde</span
                            >
                        </h1>
                        <p class="subtitle">
                            or <span class="d17e">d17e</span> for short
                        </p>
                    </div>
                </div>
                <p class="intro-text">
                    Software engineer by <em>trade</em>.
                    <br />
                    Artist at <em>heart</em>.
                    <br />
                    <br />
                    Welcome to my corner of the internet.
                </p>
            </div>
        </section>

        <!-- Code Section -->

        <section class="section code-section">
            <div class="section-content">
                <div class="section-label">I code.</div>
                <h2>Software Engineering</h2>
                <p>
                    I've spent the last two decades building software and
                    products across a variety of industries and technologies.
                    <br />
                    From enterprise systems to creative tooling. No matter the project,
                    I bring care and pragmatism to the table.
                    <br />
                </p>
                {
                    featuredProjects.length > 0 && (
                        <div class="section-featured-label">Featured projects</div>
                        <FeaturedGrid items={featuredProjects} />
                    )
                }
                <div class="section-links">
                    <a href="/projects" class="section-link">
                        <span>Browse all projects</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- Art Section -->
        <section class="section art-section">
            <div class="section-content">
                <div class="section-label">I art.</div>
                <h2>Creative Exploration</h2>
                <p>
                    Since 2023, I've been carving out space for artistic
                    exploration. What started as experiments with generative art
                    has grown into a practice spanning video, pen plotting, and
                    creative coding.
                    <br />
                    I document my practice under the media section.
                </p>
                {
                    featuredPosts.length > 0 && (
                        <div class="section-featured-label">Featured media</div>
                        <FeaturedGrid items={featuredPosts} />
                    )
                }
                <div class="section-links">
                    <a href="/posts" class="section-link">
                        <span>Browse all media</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- Ideas Section -->
        <section class="section ideas-section">
            <div class="section-content">
                <div class="section-label">Ideas.</div>
                <h2>Thinking & Sharing</h2>
                <p>
                    I try to learn something new every day.
                    <br />
                    Whether it's diving deep into a technical challenge or exploring
                    the intersection of art and code, I try to write about it.
                    <br />
                </p>
                {
                    featuredArticles.length > 0 && (
                        <div class="section-featured-label">Featured articles</div>
                        <FeaturedGrid items={featuredArticles} />
                    )
                }
                <div class="section-links">
                    <a href="/blog" class="section-link">
                        <span>Browse all articles</span>
                    </a>
                    <a
                        href="https://buttondown.com/d17e.dev"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="section-link"
                    >
                        Subscribe to newsletter
                    </a>
                </div>
            </div>
        </section>

        <!-- Contact Section -->

        <section class="section contact-section">
            <div class="section-content">
                <h2>Let's Connect</h2>
                <p>
                    Whether you have a project in mind, want to collaborate, or
                    just want to say hello â€” I'd love to hear from you.
                </p>
                <div class="contact-actions">
                    <a
                        href="https://forms.d17e.dev/contact"
                        class="contact-cta primary"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        <span>Get in Touch</span>
                    </a>
                </div>
                <div class="social-section">
                    <SocialLinks
                        showLinkedIn={true}
                        showGitHub={true}
                        showMastodon={true}
                    />
                </div>
            </div>
        </section>

        <Footer />
    </body>
</html>

<style>
    /* Hero Section */
    .hero {
        width: 100%;
        aspect-ratio: 1472 / 448; 
        max-height: 66vh;
        max-height: 66svh;
        padding: 9rem 2rem 9rem 2rem;
        display: flex;
        background-color: var(--bg-color-transparent);
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
        box-sizing: border-box;
    }

    .hero::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 50px;
        background: linear-gradient(to bottom, transparent, var(--bg-color));
        pointer-events: none;
    }

    /* Section Base Styles */
    .section {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 6rem 2rem;
        box-sizing: border-box;
    }

    .section-content {
        max-width: 720px;
        width: 100%;
    }

    .section-label {
        display: inline-block;
        font-family: "nudica_monobold", serif;
        font-size: 1.5rem;
        padding: 0.3rem 1rem;
        margin-bottom: 1rem;
        color: var(--bg-color);
        background-color: var(--color);
    }

    .section-featured-label {
        font-family: "nudica_monolight", serif;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        color: var(--color);
    }

    .section h2 {
        font-family: "nudica_monobold", serif;
        font-size: 2.5rem;
        margin-bottom: 1.5rem;
        color: var(--color);
    }

    .section p {
        font-family: "argesta_regular", serif;
        font-size: 1.25rem;
        line-height: 1.8;
        color: var(--color);
        margin-bottom: 2rem;
    }

    .section p em {
        color: var(--color);
        font-weight: bold;
    }

    /* Introduction Section */
    .intro-section {
    }

    .intro-header {
        display: flex;
        align-items: center;
        gap: 2rem;
        margin-bottom: 2.5rem;
    }

    .avatar {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        border: 3px solid var(--color);
    }

    .intro-title h1 {
        font-family: "nudica_monobold", serif;
        font-size: 3rem;
        margin: 0;
        color: var(--color);
    }

    .intro-title .highlight {
        color: var(--color);
    }

    .intro-title .subtitle {
        font-family: "nudica_monolight", serif;
        font-size: 1.25rem;
        margin: 0.5rem 0 0;
        color: var(--color);
        opacity: 0.8;
    }

    .d17e {
        font-family: "nudica_monolight", serif;
        color: var(--color);
    }

    .intro-text {
        font-size: 1.35rem !important;
    }

    /* Code Section */
    .code-section {
    }

    .tech-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 2rem;
    }

    .tag {
        font-family: "nudica_monolight", serif;
        font-size: 0.9rem;
        padding: 0.4rem 1rem;
        background-color: var(--color);
        color: var(--bg-color);
        border-radius: 2rem;
    }

    /* Art Section */
    .art-section {
        position: relative;
    }

    .art-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
    }

    .art-mediums {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .medium {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .medium-icon {
        font-size: 1.5rem;
        color: var(--accent-color);
    }

    .medium-name {
        font-family: "nudica_monolight", serif;
        font-size: 1rem;
        color: var(--color);
    }

    /* Ideas Section */
    .ideas-section {
    }

    .ideas-focus {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        margin-bottom: 2rem;
        padding-left: 1rem;
        border-left: 3px solid var(--accent-color);
    }

    .focus-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .focus-label {
        font-family: "nudica_monobold", serif;
        font-size: 1.1rem;
        color: var(--color);
    }

    .focus-desc {
        font-family: "argesta_regular", serif;
        font-size: 1rem;
        color: var(--color);
        opacity: 0.7;
    }

    /* Section Links */
    .section-links {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 1.5rem;
    }

    .section-cta {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-family: "nudica_monobold", serif;
        font-size: 1.1rem;
        padding: 0.8rem 1.5rem;
        background-color: var(--color);
        color: var(--bg-color);
        text-decoration: none;
        transition: all 0.2s ease;
    }

    .section-cta:hover {
        transform: translateX(4px);
        opacity: 1;
    }

    .section-cta .arrow {
        transition: transform 0.2s ease;
    }

    .section-cta:hover .arrow {
        transform: translateX(4px);
    }

    .section-link {
        font-family: "nudica_monolight", serif;
        font-size: 1rem;
        color: var(--accent-color);
        text-decoration: none;
        border-bottom: 1px dashed var(--accent-color);
        padding-bottom: 2px;
    }

    .section-link:hover {
        border-bottom-style: solid;
    }

    /* Contact Section */
    .contact-section {
        text-align: center;
        position: relative;
    }

    .contact-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
    }

    .contact-section .section-content {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .contact-section h2 {
        font-size: 3rem;
    }

    .contact-section p {
        max-width: 500px;
    }

    .contact-actions {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 3rem;
    }

    .contact-cta {
        font-family: "nudica_monobold", serif;
        font-size: 1.1rem;
        padding: 1rem 2rem;
        text-decoration: none;
        transition: all 0.2s ease;
        border-radius: 999px;
    }

    .contact-cta.primary {
        background-color: var(--color);
        color: var(--bg-color);
    }

    .contact-cta.secondary {
        background-color: var(--accent-color);
        color: white;
    }

    .contact-cta:hover {
        transform: scale(1.02);
        opacity: 1;
    }

    .social-section {
        padding-top: 2rem;
        border-top: 1px solid var(--border-color);
        width: 100%;
        max-width: 400px;
    }

    @media (max-width: 600px) {
        .hero {
            padding: 6rem 2rem 6rem 2rem;
        }
    }
    /* Responsive */
    @media (max-width: 768px) {
        .section {
            padding: 4rem 1.5rem;
            min-height: auto;
        }

        .intro-header {
            flex-direction: column;
            text-align: center;
            gap: 1.5rem;
        }

        .avatar {
            width: 120px;
            height: 120px;
        }

        .intro-title h1 {
            font-size: 2.2rem;
        }

        .intro-text {
            text-align: center;
        }

        .section h2 {
            font-size: 2rem;
        }

        .section p {
            font-size: 1.1rem;
        }

        .contact-section h2 {
            font-size: 2.2rem;
        }

        .art-mediums {
            gap: 1rem;
        }

        .section-links {
            flex-direction: column;
            align-items: center;
        }

        .contact-actions {
            flex-direction: column;
            width: 100%;
            padding: 0 1rem;
            box-sizing: border-box;
        }

        .contact-cta {
            width: auto;
            text-align: center;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
        }
    }

    @media (max-width: 480px) {
        .scroll-indicator {
            bottom: 1rem;
        }

        .intro-title h1 {
            font-size: 1.8rem;
        }

        .section-label {
            font-size: 1.2rem;
        }
    }
</style>
