---
import {getCollection} from 'astro:content';

interface Props {
  currentSlug: string;
}

const {currentSlug} = Astro.props;

// Get all projects and sort them by start date (newest first)
const allProjects = await getCollection('projects');
const sortedProjects = allProjects
  .filter(project => project.data.startDate)
  .sort((a, b) => {
    return new Date(b.data.startDate || 0).getTime() - new Date(a.data.startDate || 0).getTime();
  });

// Find the index of the current project
const currentIndex = sortedProjects.findIndex(project => project.data.slug === currentSlug);
const prevProject = currentIndex > 0 ? sortedProjects[currentIndex - 1] : null;
const nextProject = currentIndex < sortedProjects.length - 1 ? sortedProjects[currentIndex + 1] : null;
---

{(prevProject || nextProject) && (
<div class="mini-nav">
  {prevProject && (
          <a href={`/projects/${prevProject.data.slug}`} class="mini-nav-link prev-link" aria-label={`Previous project: ${prevProject.data.name}`}>
            <div class="arrow">←</div>
          </a>
  )}
  
  <a href="/projects" class="mini-nav-home" aria-label="Back to projects">
    All Projects
  </a>

  {nextProject && (
          <a href={`/projects/${nextProject.data.slug}`} class="mini-nav-link next-link" aria-label={`Next project: ${nextProject.data.name}`}>
            <div class="arrow">→</div>
          </a>
  )}
</div>
)}

<style>
    .mini-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
        font-family: 'nudica_monolight', serif;
    }

    .mini-nav-link {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background-color: var(--bg-code);
        color: var(--color);
        text-decoration: none;
        transition: all 0.2s ease;
    }

    .mini-nav-link:hover {
        transform: translateY(-2px);
        box-shadow: var(--box-shadow);
    }

    .arrow {
        font-size: 1rem;
    }

    .mini-nav-home {
        font-size: 0.8rem;
        padding: 0.3rem 0.8rem;
        border-radius: 1rem;
        background-color: var(--bg-code);
        color: var(--color);
        text-decoration: none;
        transition: all 0.2s ease;
    }

    .mini-nav-home:hover {
        transform: translateY(-2px);
        box-shadow: var(--box-shadow);
    }

    @media (max-width: 768px) {
        .mini-nav {
            margin-top: 0.75rem;
        }
    }
</style>